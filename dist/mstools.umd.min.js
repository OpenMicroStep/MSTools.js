!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.MSTools=t()}}(function(){return function t(e,n,r){function o(s,u){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){"use strict";function r(t){return null!==t&&void 0!==t}function o(t){var e=typeof t;return"object"===e&&t&&"function"==typeof t.constructor&&t.constructor!=Object&&t.constructor.name||e}function i(t){return 9007199254740991>=t&&t>=-9007199254740991&&Math.floor(t)===t}function s(t,e){return t/e|0}function u(t,e,n){for(var r=e-t.length,o="";r>0;)o+=r>n.length?n:n.slice(0,r),r-=n.length;return o}function a(t,e,n){return void 0===n&&(n=" "),u(t,e,n)+t}function f(t,e,n){return void 0===n&&(n=" "),t+u(t,e,n)}function c(t,e){"string"==typeof t&&(t=p.MSBuffer.bufferFromString(t)),e=e||function(t){return t};var n,r=-1,o=t.length;for(n=0;o>n;n++)r=r>>8&16777215^l[255&(r^e(t[n]))];return(-1^r)>>>0}function h(t){return JSON.stringify(t).replace(y,function(t){return d[t]||"\\u"+a(t.charCodeAt(0).toString(16).toUpperCase(),4,"0000")})}var p=t("./types/msbuffer");n.ok=r,n.type=o,n.isInteger=i,n.div=s,n.padStart=a,n.padEnd=f;var l=function(){var t,e,n,r=[];for(e=0;256>e;e++){for(t=e,n=0;8>n;n++)t=1&t?3988292384^t>>>1:t>>>1;r[e]=t}return r}();n.crc32=c;var y=/[\/\x00-\x1f\u007f-\uffff]/g,d={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","/":"/"};n.stringify=h},{"./types/msbuffer":6}],2:[function(t,e,n){"use strict";var r=t("./mste/decoder"),o=t("./mste/encoder"),i=t("./types/mscolor");n.MSColor=i.MSColor;var s=t("./types/msbuffer");n.MSBuffer=s.MSBuffer;var u=t("./types/msdate");n.MSDate=u.MSDate;var a=t("./types/msnaturalarray");n.MSNaturalArray=a.MSNaturalArray;var f=t("./types/mscouple");n.MSCouple=f.MSCouple;var c=t("./core");n.crc32=c.crc32,n.div=c.div,n.isInteger=c.isInteger,n.ok=c.ok,n.type=c.type,n.padStart=c.padStart,n.padEnd=c.padEnd,n.stringify=c.stringify,n.MSTE={parse:r.parse,stringify:o.stringify}},{"./core":1,"./mste/decoder":3,"./mste/encoder":4,"./types/msbuffer":6,"./types/mscolor":7,"./types/mscouple":8,"./types/msdate":9,"./types/msnaturalarray":10}],3:[function(t,e,n){"use strict";function r(t,e){var n=new i(e);try{return n.parse(t)}catch(r){var o=r.message;throw r.message="unable to parse MSTE",n.index>0&&(r.message+=", at token "+(n.index-1)+": "+o,r.message+="\n"+JSON.stringify(n.tokens.slice(Math.max(0,n.index-5),Math.min(n.tokens.length,n.index+5)))),r}}var o=t("./engines"),i=function(){function t(t){var e=void 0===t?{}:t,n=e.classes,r=void 0===n?null:n,o=e.crc,i=void 0===o?!0:o;this.correspondances=r||{},this.checkCRC=!!i}return t.prototype.parse=function(t){this.keys=[],this.classes=[],this.objects=[],this.refs=[],this.index=0;var e="string"==typeof t?JSON.parse(t):t;if(!e||"number"!=typeof e.length||e.length<4)throw new Error("two few tokens");this.tokens=e;var n=e.length,r=this.nextToken();if("string"!=typeof r||!/^MSTE[0-9]{4}$/.test(r))throw new Error("the first token must be the version string");var i=o.ENGINES.find(function(t){return t.version===r});if(!i)throw new Error("no valid engine for version: "+r);this.engine=i;var s=this.nextToken();if("number"!=typeof s)throw new Error("the second token must be the number of token");if(s!==n)throw new Error("bad control count");var u=this.nextToken();if("string"!=typeof u||!/^CRC[0-9A-F]{8}$/.test(u))throw new Error("the third token must be the crc string");if(this.checkCRC&&"string"==typeof t&&"CRC00000000"!==u&&o.crc32inMSTEformat(t.replace(u,"CRC00000000"))!==u)throw new Error("crc verification failed");var a=this.nextToken();if("number"!=typeof a)throw new Error("the 4th token must be the number of classes");if(a+=this.index,1+a>n)throw new Error("not enough tokens to store classes and the root object");for(;this.index<a;){var f=this.nextToken();if("string"!=typeof f)throw new Error("class name must be a string");this.classes.push(f)}var c=this.nextToken();if("number"!=typeof c)throw new Error("the key count token must be a number");if(c+=this.index,1+c>n)throw new Error("not enough tokens to store keys and the root object");for(;this.index<c;){var h=this.nextToken();if("string"!=typeof h)throw new Error("key name must be a string");this.keys.push(h)}return this.parseItem()},t.prototype.nextToken=function(){if(this.index<this.tokens.length)return this.tokens[this.index++];throw new Error("not enough tokens")},t.prototype.pushRef=function(t){return this.refs.push(t),t},t.prototype.parseItem=function(){var t=this.nextToken();if("number"!=typeof t)throw new Error("code token must be a number");if(t>=50){var e=this.engine.classIndex(t);if(e>=this.classes.length)throw new Error("");var n=this.classes[e],r=this.correspondances[n],o=this.pushRef(r?new r:{});return this.engine.parse_dictionary_into(this,o),o}var i=this.engine.parsers[t];if(!i)throw new Error("unknown code token '"+t+"'");return i(this)},t}();n.Decoder=i,n.parse=r},{"./engines":5}],4:[function(t,e,n){"use strict";function r(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:n})}function o(t){t.encodeBuffer(this)}function i(t,e){var n=e&&e.version||258,r=u.ENGINES.find(function(t){return t.versionCode===n});if(!r)throw new Error("no valid engine with version: "+n);return r.tokenize(t,e)}function s(t,e){var n=i(t,e);return n[2]=u.crc32inMSTEformat(a.stringify(n)),a.stringify(n)}var u=t("./engines"),a=t("../core"),f=t("../types/mscolor"),c=t("../types/msbuffer"),h=t("../types/mscouple"),p=t("../types/msdate"),l=t("../types/msnaturalarray");r(Object.prototype,"toMSTE",function(t){return s(this,t)}),r(Object.prototype,"encodeToMSTE",function(t){t.encodeDictionary(this)}),r(Array.prototype,"encodeToMSTE",function(t){t.encodeArray(this)}),r(Date.prototype,"encodeToMSTE",function(t){t.encodeGMTDate(this)}),r(p.MSDate.prototype,"encodeToMSTE",function(t){t.encodeLocalDate(this)}),r(c.MSBuffer.prototype,"encodeToMSTE",function(t){t.encodeBuffer(this)}),r(f.MSColor.prototype,"encodeToMSTE",function(t){t.encodeColor(this)}),r(l.MSNaturalArray.prototype,"encodeToMSTE",function(t){t.encodeNaturals(this)}),r(h.MSCouple.prototype,"encodeToMSTE",function(t){t.encodeCouple(this)}),[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array].map(function(t){r(t.prototype,"encodeToMSTE",o)}),n.tokenize=i,n.stringify=s},{"../core":1,"../types/msbuffer":6,"../types/mscolor":7,"../types/mscouple":8,"../types/msdate":9,"../types/msnaturalarray":10,"./engines":5}],5:[function(t,e,n){"use strict";function r(t){return null}function o(t){return!0}function i(t){return!1}function s(t){return""}function u(t){return new F.MSBuffer}function a(){return new Date(X)}function f(){return new Date(L)}function c(t){var e=t.nextToken(),n=t.refs.length;if(n>e)return t.refs[e];throw new Error("referenced object index is too big ("+e+" < "+n+")")}function h(t){var e=t.nextToken();if("number"==typeof e)return e;throw new Error("a number was expected")}function p(t){var e=h(t);if(!V.isInteger(e))throw new Error("an integer was expected");return e}function l(t){return t.pushRef(h(t))}function y(t){return t.pushRef(p(t))}function d(t,e){return function(n){return Math.max(t,Math.min(e,h(n)))}}function m(t){return t.pushRef(h(t))}function g(t){return t.pushRef(new R.MSDate(h(t)-R.MSDate.SecsFrom19700101To20010101))}function v(t){return t.pushRef(new Date(1e3*h(t)))}function w(t){return t.pushRef(new j.MSColor(h(t)))}function b(t){var e=t.nextToken();if("string"==typeof e)return e;throw new Error("a string was expected")}function k(t){return t.pushRef(b(t))}function M(t){return t.pushRef(F.MSBuffer.bufferWithBase64String(b(t)))}function T(t){for(var e=h(t),n=t.pushRef(new N.MSNaturalArray);e>0;)n.push(h(t)),e--;return n}function S(t,e){for(var n=h(t);n>0;){var r=t.keys[h(t)],o=t.parseItem();e[r]=o,n--}}function E(t){var e=t.pushRef({});return S(t,e),e}function O(t){for(var e=h(t),n=t.pushRef([]);e>0;)n.push(t.parseItem()),e--;return n}function I(t){var e=t.pushRef(new B.MSCouple);return e.firstMember=t.parseItem(),e.secondMember=t.parseItem(),e}function A(t,e){var n=t.get(e);return void 0===n&&t.set(e,n=t.size),n}function C(t,e){var n=t.size;e.push(n);var r=e.length;e.length+=n,t.forEach(function(t,n){e[r+t]=n})}function D(t){return"CRC"+V.padStart(V.crc32(t).toString(16),8,"0").toUpperCase()}var x=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},F=t("../types/msbuffer"),j=t("../types/mscolor"),N=t("../types/msnaturalarray"),R=t("../types/msdate"),B=t("../types/mscouple"),V=t("../core"),X=-864e13,L=864e13,P=d(-128,127),_=d(0,255),q=d(-32768,32767),Y=d(0,65535),W=d(-2147483648,2147483647),G=d(0,4294967295),z=d(-0x8000000000000000,0x8000000000000000),U=d(0,0x10000000000000000),J=function(){function t(t){this.tokens=[this.engine.version,0,"CRC00000000",0,0],this.references=new Map,this.keys=new Map,this.classes=new Map}return t.prototype.encodeRoot=function(t){this.encodeObject(t),this.finalize()},t.prototype.finalize=function(){var t=[];C(this.classes,t),C(this.keys,t),t.length>2&&(e=this.tokens).splice.apply(e,[3,2].concat(t)),this.tokens[1]=this.tokens.length;var e},t.prototype.encodeObject=function(t){switch(typeof t){case"object":null===t?this.encodeNil():t.encodeToMSTE(this);break;case"number":V.isInteger(t)?this.encodeInteger(t):this.encodeReal(t);break;case"string":this.encodeString(t);break;case"boolean":this.encodeBoolean(t);break;default:throw new Error("unsupported typeof object")}},t.prototype.encodeNil=function(){this.pushToken(0)},t.prototype.encodeBoolean=function(t){this.pushToken(t?1:2)},t.prototype.encodeRef=function(t){this.pushToken(9),this.pushToken(t)},t.prototype.encodeKey=function(t){this.pushToken(this.keyIndex(t))},t.prototype.keyIndex=function(t){return A(this.keys,t)},t.prototype.classIndex=function(t){return A(this.classes,t)},t.prototype.encodeStringV10X=function(t,e,n){this.shouldPushObject(t)&&(0===t.length?this.pushToken(e):(this.pushToken(n),this.pushToken(t)))},t.prototype.encodeArrayV10X=function(t,e){if(this.shouldPushObject(t)){this.pushToken(e);var n,r=t.length;for(this.pushToken(r),n=0;r>n;n++)this.encodeObject(t[n])}},t.prototype.encodeNaturalsV10X=function(t,e){if(this.shouldPushObject(t)){this.pushToken(e);var n,r=t.length;for(this.pushToken(r),n=0;r>n;n++)this.pushToken(t[n])}},t.prototype.encodeDictionaryV10X=function(t,e){if(this.shouldPushObject(t)){this.pushToken(e);var n=Object.keys(t);this.pushToken(n.length);for(var r=0,o=n;r<o.length;r++){var i=o[r];this.encodeKey(i),this.encodeObject(t[i])}}},t.prototype.encodeColorV10X=function(t,e){this.shouldPushObject(t)&&(this.pushToken(e),this.pushToken(t.toNumber()))},t.prototype.encodeBufferV10X=function(t,e){this.shouldPushObject(t)&&(this.pushToken(e),t instanceof F.MSBuffer||(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),this.pushToken(F.MSBuffer.encodeToBase64(t)))},t.prototype.encodeGMTDateV10X=function(t,e){this.shouldPushObject(t)&&(this.pushToken(e),this.pushToken(t.getTime()/1e3))},t.prototype.encodeLocalDateV10X=function(t,e){this.shouldPushObject(t)&&(this.pushToken(e),this.pushToken(t.secondsSinceLocal1970()))},t.prototype.encodeCoupleV10X=function(t,e){this.shouldPushObject(t)&&(this.pushToken(e),this.encodeObject(t.firstMember),this.encodeObject(t.secondMember))},t.prototype.pushToken=function(t){this.tokens.push(t)},t.prototype.shouldPushObject=function(t){var e=this.references.get(t);return void 0!==e?(this.encodeRef(e),!1):(this.references.set(t,this.references.size),!0)},t}(),H=function(t){function e(){t.apply(this,arguments)}return x(e,t),e.prototype.encodeInteger=function(t){this.shouldPushObject(t)&&(this.pushToken(3),this.pushToken(t))},e.prototype.encodeReal=function(t){this.shouldPushObject(t)&&(this.pushToken(4),this.pushToken(t))},e.prototype.encodeString=function(t){this.encodeStringV10X(t,26,5)},e.prototype.encodeArray=function(t){this.encodeArrayV10X(t,20)},e.prototype.encodeNaturals=function(t){this.encodeNaturalsV10X(t,21)},e.prototype.encodeDictionary=function(t,e){this.encodeDictionaryV10X(t,e?50+2*this.classIndex(e):8)},e.prototype.encodeColor=function(t){this.encodeColorV10X(t,7)},e.prototype.encodeBuffer=function(t){this.encodeBufferV10X(t,23)},e.prototype.encodeGMTDate=function(t){var e=t.getTime();X>=e?this.pushToken(24):e>=L?this.pushToken(25):this.encodeGMTDateV10X(t,6)},e.prototype.encodeLocalDate=function(t){this.encodeGMTDate(t.toDate())},e.prototype.encodeCouple=function(t){this.encodeCoupleV10X(t,22)},e}(J);H.prototype.engine={version:"MSTE0101",versionCode:257,parse_dictionary_into:S,parsers:{0:r,1:o,2:i,3:y,4:l,5:k,6:v,7:w,8:E,9:c,10:P,11:_,12:q,13:Y,14:W,15:G,16:z,17:U,18:h,19:h,20:O,21:T,22:I,23:M,24:a,25:f,26:s,27:c},tokenize:function(t,e){var n=new H(e);return n.encodeRoot(t),n.tokens},classIndex:function(t){return(t%2===0?t-50:t-51)/2|0}};var K=function(t){function e(){t.apply(this,arguments)}return x(e,t),e.prototype.encodeInteger=function(t){this.shouldPushObject(t)&&(this.pushToken(20),this.pushToken(t))},e.prototype.encodeReal=function(t){this.shouldPushObject(t)&&(this.pushToken(20),this.pushToken(t))},e.prototype.encodeString=function(t){this.encodeStringV10X(t,3,21)},e.prototype.encodeArray=function(t){this.encodeArrayV10X(t,31)},e.prototype.encodeNaturals=function(t){this.encodeNaturalsV10X(t,26)},e.prototype.encodeDictionary=function(t,e){this.encodeDictionaryV10X(t,e?50+this.classIndex(e):30)},e.prototype.encodeColor=function(t){this.encodeColorV10X(t,24)},e.prototype.encodeBuffer=function(t){t.length>0?this.encodeBufferV10X(t,25):this.pushToken(4)},e.prototype.encodeGMTDate=function(t){this.encodeGMTDateV10X(t,23)},e.prototype.encodeLocalDate=function(t){this.encodeLocalDateV10X(t,22)},e.prototype.encodeCouple=function(t){this.encodeCoupleV10X(t,32)},e}(J);K.prototype.engine={version:"MSTE0102",versionCode:258,parse_dictionary_into:S,parsers:{0:r,1:o,2:i,3:s,4:u,9:c,10:P,11:_,12:q,13:Y,14:W,15:G,16:z,17:U,18:h,19:h,20:m,21:k,22:g,23:v,24:w,25:M,26:T,30:E,31:O,32:I},tokenize:function(t,e){var n=new K(e);return n.encodeRoot(t),n.tokens},classIndex:function(t){return t-50}},n.ENGINES=[K.prototype.engine,H.prototype.engine],n.crc32inMSTEformat=D},{"../core":1,"../types/msbuffer":6,"../types/mscolor":7,"../types/mscouple":8,"../types/msdate":9,"../types/msnaturalarray":10}],6:[function(t,e,n){"use strict";function r(t){return t&&"number"==typeof t.length}function o(t,e,n,r,o){var s=[];i(s,e,n,r,o),Array.prototype.unshift.apply(t,s)}function i(t,e,n,o,s){for(var u=e,a=n.length;a>u;u++){var f=n[u];if(o&&r(f))i(t,0,f,!1,s);else{var c=t.length;t.length++,t[c]=s(f)}}}function s(t){return 255&Math.max(0,0|t)}var u=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=[-2,-2,-2,-2,-2,-2,-2,-2,-2,-1,-1,-2,-2,-1,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-1,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,62,-2,-2,-2,63,52,53,54,55,56,57,58,59,60,61,-2,-2,-2,-2,-2,-2,-2,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-2,-2,-2,-2,-2,-2,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-2,-2,-2,-2,-2],c="=",h=[function(t,e,n){e[0]=n<<2&255},function(t,e,n){e[0]|=n>>4,e[1]=(15&n)<<4&255},function(t,e,n){e[1]|=n>>2,e[2]=(3&n)<<6&255},function(t,e,n){e[2]|=n,t.push(e[0],e[1],e[2]),e[0]=e[1]=e[2]=0}];n.unshift=o,n.push=i;var p=function(t){function e(){t.call(this);var e=arguments.length;if(1===e&&"string"==typeof arguments[0])for(var n=arguments[0],r=0,o=n.length;o>r;r++)this.push(255&n.charCodeAt(r));else i(this,0,arguments,!0,s)}return u(e,t),e.bufferFromString=function(t,n){void 0===n&&(n="utf8");var r,o=new e,i=t.length;for(r=0;i>r;r++){var s=t.charCodeAt(r);128>s?o.push(s):2048>s?(o.push(s>>6|192),o.push(63&s|128)):(o.push(s>>12|224),o.push(s>>6&63|128),o.push(63&s|128))}return o},e.bufferWithBase64String=function(t,n,r){var o=t.length,i=new e;if(o>0){var s,u,a,p=0,l=[];l[0]=l[1]=l[2]=0,n=n||f;var y=(r||c).charCodeAt(0);for(s=0;o>s&&(u=t.charCodeAt(s),u!==y);s++){if(u>127)throw new Error("bad character");if(a=n[u],-1!==a){if(-2===a)throw new Error("bad character");h[p%4](i,l,a),p++}}if(u===y){if(p%=4,1===p)throw new Error("bad character");for(p--,s=0;p>s;s++)i.push(l[s])}}return i},e.prototype.unshift=function(){return o(this,0,arguments,!1,s),this.length},e.prototype.push=function(){return i(this,0,arguments,!1,s),this.length},e.prototype.concat=function(){var t=new e;return Array.prototype.push.apply(t,this),i(t,0,arguments,!0,s),t},e.prototype.slice=function(t,n){return new e(Array.prototype.slice.apply(this,arguments))},e.prototype.splice=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return new e(Array.prototype.splice.apply(this,arguments))},e.prototype.toJSON=function(){return Array.from(this)},e.prototype.isEqualTo=function(t){return t instanceof e&&this.isEqualToBuffer(t)},e.prototype.isEqualToBuffer=function(t){if(this===t)return!0;if(!t||t.length!==this.length)return!1;for(var e=0,n=this.length;n>e;e++)if(this[e]!==t[e])return!1;return!0},e.prototype.toString=function(){var t,e=this.length;if(e){var n=[];for(t=0;e>t;t++)n.push(String.fromCharCode(this[t]));return n.join("")}return""},e.prototype.toBase64String=function(t,n){return e.encodeToBase64(this,t,n)},e.encodeToBase64=function(t,e,n){var r,o,i,s="";if(e=e||a,n=n||c,0===t.length)return"";for(o=t.length-t.length%3,r=0;o>r;r+=3)i=t[r]<<16|t[r+1]<<8|t[r+2],s+=e.charAt(i>>18),s+=e.charAt(i>>12&63),s+=e.charAt(i>>6&63),s+=e.charAt(63&i);switch(t.length-o){case 1:i=t[r]<<16,s+=e.charAt(i>>18)+e.charAt(i>>12&63)+n+n;break;case 2:i=t[r]<<16|t[r+1]<<8,s+=e.charAt(i>>18)+e.charAt(i>>12&63)+e.charAt(i>>6&63)+n}return s},e}(Array);n.MSBuffer=p},{}],7:[function(t,e,n){"use strict";function r(t){if(0>t||t>255||Math.floor(t)!==t)throw new Error("invalid color value");return t}function o(t){var e=t.toString(16);return e.length<2?"00".slice(0,2-e.length)+e:e}var i={beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",fuchsia:"#ff00ff",gold:"#ffd700",gray:"#808080",green:"#008000",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",magenta:"#ff00ff",maroon:"#800000",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",red:"#ff0000",salmon:"#fa8072",silver:"#c0c0c0",snow:"#fffafa",teal:"#008080",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",yellow:"#ffff00"},s={4:{rx:/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/,mult:16},7:{rx:/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,mult:1},9:{rx:/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,mult:1}},u=[function(t,e,n,r){return new a(t,r,e)},function(t,e,n,r){return new a(n,t,e)},function(t,e,n,r){return new a(e,t,r)},function(t,e,n,r){return new a(e,n,t)},function(t,e,n,r){return new a(r,e,t)},function(t,e,n,r){return new a(t,e,n)},function(t,e,n,r){return new a(t,r,e)}],a=function(){function t(t,e,n,o){if("string"==typeof t){t=t.replace(/ /g,""),t=i[t]||t;var u=s[t.length],a=u&&t.match(u.rx);if(a)return this.red=parseInt(a[1],16)*u.mult,this.green=parseInt(a[2],16)*u.mult,this.blue=parseInt(a[3],16)*u.mult,void(this.alpha=a[4]?parseInt(a[4],16)*u.mult:255);throw new Error("invalid color value")}if("number"==typeof t){if("number"==typeof e&&"number"==typeof n)return this.red=r(t),this.green=r(e),this.blue=r(n),void(this.alpha="number"==typeof o?r(o):255);if(void 0===e)return this.alpha=255-(t>>24&255),this.red=t>>16&255,this.green=t>>8&255,void(this.blue=255&t)}throw new Error("invalid constructor parameters")}return t.lighter=function(t){return t/=255,Math.round(255*(2*t*t/3+t/2+.25))},t.darker=function(t){return t/=255,Math.round(255*(-t*t/3+5*t/6))},t.colorWithHSB=function(e,n,r){if("object"==typeof e&&"h"in e&&"s"in e&&"b"in e&&(r=e.b,n=e.s,e=e.h),0!==r){var o=Math.max(0,Math.floor(6*e))%7,i=6*e-o,s=r*(1-n),a=r*(1-n*i),f=r*(1-n*(1-i));return u[o](r,s,a,f)}return t.BLACK},t.prototype.luminance=function(){return(.3*this.red+.59*this.green+.11*this.blue)/255},t.prototype.isPale=function(){return this.luminance()>.6?!0:!1},t.prototype.lighterColor=function(){return new t(t.lighter(this.red),t.lighter(this.green),t.lighter(this.blue),this.alpha)},t.prototype.darkerColor=function(){return new t(t.darker(this.red),t.darker(this.green),t.darker(this.blue),this.alpha)},t.prototype.lightest=function(){return new t(t.darker(t.darker(this.red)),t.darker(t.darker(this.green)),t.darker(t.darker(this.blue)),this.alpha)},t.prototype.darkest=function(){return new t(t.darker(t.darker(this.red)),t.darker(t.darker(this.green)),t.darker(t.darker(this.blue)),this.alpha)},t.prototype.matchingColor=function(){return this.isPale()?this.darkest():this.lightest()},t.prototype.toString=function(){return 255===this.alpha?"#"+o(this.red)+o(this.green)+o(this.blue):"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha/255+")"},t.prototype.toNumber=function(){return 16777216*(255-this.alpha)+65536*this.red+256*this.green+this.blue},t.prototype.toHSB=function(){var t=this.red/255,e=this.green/255,n=this.blue/255,r=Math.max(t,e,n),o=Math.min(t,e,n),i=0,s=0,u=r;if(r>o){var a=r-o;s=a/r,i=t===r?(e-n)/a:e===r?2+(n-t)/a:4+(t-e)/a,i/=6,0>i&&(i+=1),i>1&&(i-=1)}return{h:i,s:s,b:u}},t.prototype.isEqualTo=function(e){return e instanceof t&&this.isEqualToColor(e)},t.prototype.isEqualToColor=function(t){return this===t||t&&t.toNumber()===this.toNumber()},t.prototype.toJSON=function(){return this.toString()},t.RED=new t(255,0,0),t.GREEN=new t(0,255,0),t.YELLOW=new t(255,255,0),t.BLUE=new t(0,0,255),t.CYAN=new t(0,255,255),t.MAGENTA=new t(255,0,255),t.WHITE=new t(255,255,255),t.BLACK=new t(0,0,0),t}();n.MSColor=a},{}],8:[function(t,e,n){"use strict";var r=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.firstMember=t,this.secondMember=e}return t.prototype.toArray=function(){return[this.firstMember,this.secondMember]},t.prototype.isEqualTo=function(e){return e instanceof t&&this.isEqualToCouple(e)},t.prototype.isEqualToCouple=function(t){return t.firstMember===this.firstMember&&t.secondMember===this.secondMember},t}();n.MSCouple=r},{}],9:[function(t,e,n){"use strict";function r(t){return t>10?""+t:"0"+t}var o=t("../core"),i=730792,s=730485,u=63113904e3,a=978307200,f=[0,31,28,31,30,31,30,31,31,30,31,30,31],c=[0,0,0,0,31,61,92,122,153,184,214,245,275,306,337],h=function(){function t(){var e=arguments.length;if(e>=3){if(!t.validDate(arguments[0],arguments[1],arguments[2]))throw"Bad MSDate() day arguments";if(3!==e&&6!==e)throw"Impossible to initialize a new MSDate() with "+e+" arguments";if(6===e){if(!t.validTime(arguments[3],arguments[4],arguments[5]))throw"Bad MSDate() time arguments";this.interval=t.intervalFrom(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])}else this.interval=t.intervalFrom(arguments[0],arguments[1],arguments[2],0,0,0)}else{if(2===e)throw"Impossible to initialize a new MSDate() with 2 arguments";var n=arguments[0];if("number"==typeof n)this.interval=n;else if(n instanceof t)this.interval=n.interval;else{var r=n instanceof Date?n:new Date;this.interval=t.intervalFrom(r.getFullYear(),r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds())}}}return t.isLeapYear=function(t){return t%4?!1:t%100?t>7?!0:!1:t%400||1600>t?!1:!0},t.validDate=function(e,n,r){return!o.isInteger(r)||!o.isInteger(n)||!o.isInteger(e)||1>r||1>n||n>12?!1:r>f[n]?2===n&&29===r&&t.isLeapYear(e)?!0:!1:!0},t.validTime=function(t,e,n){return o.isInteger(t)&&o.isInteger(e)&&!isNaN(n)&&t>=0&&24>t&&e>=0&&60>e&&n>=0&&60>n},t.intervalFromYMD=function(t,e,n){var r;return e=0|e,3>e&&(e+=12,t--),r=Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400),Math.floor(86400*(n+c[e]+365*t+r-i))},t.intervalFrom=function(e,n,r,o,i,s){return t.intervalFromYMD(e,n,r)+3600*o+60*i+s},t.timeFromInterval=function(t){return(t+u)%86400},t.dayFromInterval=function(e){return Math.floor((e-t.timeFromInterval(e))/86400)},t.secondsFromInterval=function(t){return(t+u)%60},t.minutesFromInterval=function(t){return o.div(Math.floor((t+u)%3600),60)},t.hoursFromInterval=function(t){return o.div(Math.floor((t+u)%86400),3600)},t.dayOfWeekFromInterval=function(e,n){return n=n||0,(t.dayFromInterval(e)+s+7-n%7)%7},t.componentsWithInterval=function(e){var n=t.dayFromInterval(e)+i,r=n-.25,o=Math.floor(r/36524.25),s=o-Math.floor(o/4),u=r+s,a=Math.floor(u/365.25),f=Math.floor(365.25*a),c=s+n-f,h=Math.floor((5*c+456)/153);return{day:Math.floor(c-Math.floor((153*h-457)/5)),hour:t.hoursFromInterval(e),minute:t.minutesFromInterval(e),seconds:t.secondsFromInterval(e),dayOfWeek:(n+2)%7,month:h>12?h-12:h,year:h>12?a+1:a}},t._lastDayOfMonth=function(e,n){return 2===n&&t.isLeapYear(e)?29:f[n]},t._yearRef=function(e,n){var r=t.intervalFromYMD(e,1,1),o=t.dayOfWeekFromInterval(r,n);return o=3>=o?-o:7-o,r+86400*o},t.prototype.components=function(){return t.componentsWithInterval(this.interval)},t.prototype.isEqualTo=function(e){return e instanceof t&&e.interval===this.interval},t.prototype.isLeap=function(){return t.isLeapYear(this.components().year)},t.prototype.yearOfCommonEra=function(){return this.components().year},t.prototype.monthOfYear=function(){return this.components().month},t.prototype.weekOfYear=function(e){void 0===e&&(e=0);var n,r=this.components();e%=7;var o=t._yearRef(r.year,e);return this.interval<o?(o=t._yearRef(r.year-1,e),n=Math.floor((this.interval-o)/604800)+1):(n=Math.floor((this.interval-o)/604800)+1,53===n&&(o+=31449600,r=t.componentsWithInterval(o),r.day>=29&&(n=1))),n},t.prototype.dayOfYear=function(){return Math.floor((this.interval-t.intervalFromYMD(this.components().year,1,1))/86400)+1},t.prototype.dayOfMonth=function(){return this.components().day},t.prototype.lastDayOfMonth=function(){var e=this.components();return t._lastDayOfMonth(e.year,e.month)},t.prototype.dayOfWeek=function(e){return t.dayOfWeekFromInterval(this.interval,e)},t.prototype.hourOfDay=function(){return t.hoursFromInterval(this.interval)},t.prototype.secondOfDay=function(){return t.timeFromInterval(this.interval)},t.prototype.minuteOfHour=function(){return t.minutesFromInterval(this.interval)},t.prototype.secondOfMinute=function(){return t.secondsFromInterval(this.interval)},t.prototype.dateWithoutTime=function(){return new t(this.interval-t.timeFromInterval(this.interval))},t.prototype.dateOfFirstDayOfYear=function(){var e=this.components();return new t(e.year,1,1)},t.prototype.dateOfLastDayOfYear=function(){var e=this.components();return new t(e.year,12,31)},t.prototype.dateOfFirstDayOfMonth=function(){var e=this.components();return new t(e.year,e.month,1)},t.prototype.dateOfLastDayOfMonth=function(){var e=this.components();return new t(e.year,e.month,t._lastDayOfMonth(e.year,e.month))},t.prototype.secondsSinceLocal1970=function(){return this.interval+a},t.prototype.secondsSinceLocal2001=function(){return this.interval},t.prototype.toDate=function(){var t=this.components();return new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.seconds,0)},t.prototype.toISOString=function(){var t=this.components();return t.year+"-"+r(t.month)+"-"+r(t.day)+"T"+r(t.hour)+":"+r(t.minute)+":"+r(t.seconds)},t.prototype.toString=function(){return this.toISOString()},t.prototype.toJSON=function(){return this.toISOString()},t.DaysFrom00000229To20010101=i,t.DaysFrom00010101To20010101=s,t.SecsFrom00010101To20010101=u,t.SecsFrom19700101To20010101=a,t}();n.MSDate=h},{"../core":1}],10:[function(t,e,n){"use strict";function r(t){return 0|t}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=t("./msbuffer"),s=function(t){function e(){t.call(this),i.push(this,0,arguments,!0,r)}return o(e,t),e.prototype.unshift=function(){return i.unshift(this,0,arguments,!1,r),this.length},e.prototype.push=function(){return i.push(this,0,arguments,!1,r),this.length},e.prototype.concat=function(){var t=new e;return Array.prototype.push.apply(t,this),i.push(t,0,arguments,!0,r),t},e.prototype.slice=function(t,n){return new e(Array.prototype.slice.apply(this,arguments))},e.prototype.splice=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return new e(Array.prototype.splice.apply(this,arguments))},e.prototype.toJSON=function(){return Array.from(this)},e.prototype.isEqualTo=function(t){return t instanceof e&&this.isEqualToArray(t)},e.prototype.isEqualToArray=function(t){if(this===t)return!0;if(!t||t.length!==this.length)return!1;for(var e=0,n=this.length;n>e;e++)if(this[e]!==t[e])return!1;return!0},e}(Array);n.MSNaturalArray=s},{"./msbuffer":6}]},{},[2])(2)});